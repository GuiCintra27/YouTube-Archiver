# üç™ Guia Completo: Exportar Cookies do YouTube

## üîç Diagn√≥stico do Problema

**Status Atual:**
- ‚ùå cookies.txt existe mas **n√£o cont√©m cookies do YouTube**
- ‚ùå YouTube est√° bloqueando: "Sign in to confirm you're not a bot"
- ‚ö†Ô∏è Cookies atuais s√£o de outro site (n√£o YouTube)

---

## ‚úÖ Solu√ß√£o: Exportar Cookies Corretos

### M√©todo 1: DevTools do Chrome (Manual - Recomendado)

#### Passo 1: Acessar YouTube Logado

1. Abra o Chrome
2. V√° para https://www.youtube.com
3. **Fa√ßa login** na sua conta
4. Navegue um pouco (veja alguns v√≠deos)

#### Passo 2: Abrir DevTools

1. Pressione `F12` ou `Ctrl+Shift+I`
2. V√° na aba **Application** (ou **Aplicativo**)
3. No menu lateral esquerdo, expanda **Cookies**
4. Clique em `https://www.youtube.com`

#### Passo 3: Identificar Cookies Importantes

Procure por estes cookies (os mais importantes):

```
‚úÖ CONSENT
‚úÖ VISITOR_INFO1_LIVE
‚úÖ LOGIN_INFO
‚úÖ PREF
‚úÖ SID
‚úÖ SSID
‚úÖ APISID
‚úÖ SAPISID
‚úÖ HSID
```

#### Passo 4: Copiar Cookies Manualmente

Para cada cookie importante:
1. Clique nele
2. Copie o **Name** e **Value**
3. Anote tamb√©m o **Expires** (importante!)

#### Passo 5: Criar cookies.txt no Formato Netscape

Crie arquivo `python/cookies.txt` com este formato:

```
# Netscape HTTP Cookie File
# This file is generated by yt-dlp. Do not edit.

.youtube.com	TRUE	/	TRUE	[EXPIRY]	CONSENT	[VALUE]
.youtube.com	TRUE	/	FALSE	[EXPIRY]	VISITOR_INFO1_LIVE	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	LOGIN_INFO	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	PREF	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	SID	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	SSID	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	APISID	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	SAPISID	[VALUE]
.youtube.com	TRUE	/	TRUE	[EXPIRY]	HSID	[VALUE]
```

**Formato de cada linha:**
```
[domain] [flag] [path] [secure] [expiry] [name] [value]
```

**Exemplo real:**
```
.youtube.com	TRUE	/	TRUE	1735689600	CONSENT	YES+cb.20220419-17-p0.en+FX+000
.youtube.com	TRUE	/	FALSE	1735689600	VISITOR_INFO1_LIVE	abc123def456
```

---

### M√©todo 2: Extens√£o do Navegador (Mais F√°cil)

#### Chrome/Edge

1. Instale: [Get cookies.txt LOCALLY](https://chrome.google.com/webstore/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc)
2. V√° para https://www.youtube.com (logado)
3. Clique no √≠cone da extens√£o
4. Clique em "Export" ou "Get cookies.txt"
5. Salve como `python/cookies.txt`

#### Firefox

1. Instale: [cookies.txt](https://addons.mozilla.org/firefox/addon/cookies-txt/)
2. V√° para https://www.youtube.com (logado)
3. Clique no √≠cone da extens√£o
4. Exportar cookies
5. Salve como `python/cookies.txt`

---

### M√©todo 3: yt-dlp --cookies-from-browser (Autom√°tico)

**Mais simples e confi√°vel:**

```bash
# Chrome
python main.py download "URL" --cookies-from-browser chrome

# Firefox
python main.py download "URL" --cookies-from-browser firefox

# Edge
python main.py download "URL" --cookies-from-browser edge

# Brave
python main.py download "URL" --cookies-from-browser brave
```

**Vantagens:**
- ‚úÖ Extrai cookies automaticamente
- ‚úÖ Sempre atualizados
- ‚úÖ N√£o precisa exportar manualmente

**Desvantagens:**
- ‚ùå Navegador precisa estar fechado
- ‚ùå Pode precisar de permiss√µes especiais

---

## üõ†Ô∏è Script para Exportar via DevTools (Console)

Cole isto no **Console** do DevTools (F12 > Console):

```javascript
// Copiar todos os cookies do YouTube para clipboard
copy(document.cookie.split(';').map(c => {
  const [name, value] = c.trim().split('=');
  const cookie = document.cookie.split(';').find(c => c.trim().startsWith(name));
  return `.youtube.com\tTRUE\t/\tTRUE\t${Math.floor(Date.now()/1000) + 31536000}\t${name}\t${value}`;
}).join('\n'));

console.log('‚úÖ Cookies copiados! Cole em python/cookies.txt');
```

**Depois:**
1. Pressione `Enter`
2. Os cookies foram copiados para clipboard
3. Cole no arquivo `python/cookies.txt`

---

## üß™ Testar Cookies

### Teste R√°pido

```bash
cd python
source .venv/bin/activate

# Testar com cookies
yt-dlp --cookies cookies.txt --skip-download \
  "https://www.youtube.com/watch?v=jNQXAC9IVRw"
```

**Esperado:**
```
‚úÖ [youtube] jNQXAC9IVRw: Downloading webpage
‚úÖ [youtube] jNQXAC9IVRw: Downloading ios player API JSON
```

**Se ainda der erro:**
```
‚ùå Sign in to confirm you're not a bot
‚Üí Cookies inv√°lidos ou expirados
```

---

## üîß Atualizar Backend para Usar --cookies-from-browser

Vou criar uma op√ß√£o na interface para usar cookies do navegador:

### Adicionar no Frontend

```tsx
// Novo campo no formul√°rio
const [cookiesSource, setCookiesSource] = useState<"file" | "browser">("file");
const [browserType, setBrowserType] = useState("chrome");
```

### Adicionar no Backend

```python
# api.py - novo par√¢metro
cookies_from_browser: Optional[str] = None

# downloader.py
if s.cookies_from_browser:
    ydl_opts["cookiesfrombrowser"] = (s.cookies_from_browser,)
```

---

## ‚è∞ Alternativas se Cookies N√£o Funcionarem

### 1. Aguardar (Recomendado)

YouTube rate limits geralmente duram:
- **Leve:** 6-12 horas
- **Moderado:** 24 horas
- **Severo:** 2-3 dias

### 2. Mudar IP

```bash
# Desligar/Religar modem (IP din√¢mico)
# ou usar VPN
```

### 3. Usar Proxy

```bash
python main.py download "URL" \
  --proxy "socks5://127.0.0.1:1080"
```

### 4. Espa√ßar Downloads

No c√≥digo, adicionar delay:

```python
import time
time.sleep(5)  # 5 segundos entre v√≠deos
```

---

## üìä Checklist de Solu√ß√£o

- [ ] Cookies exportados cont√™m `youtube.com`?
- [ ] Cookies t√™m `CONSENT` e `VISITOR_INFO1_LIVE`?
- [ ] Arquivo est√° no formato Netscape correto?
- [ ] YouTube est√° aberto e logado ao exportar?
- [ ] Cookies n√£o est√£o expirados?
- [ ] Testou com `--cookies-from-browser`?

---

## üö® Erro Comum: Formato Incorreto

**‚ùå Errado:**
```
CONSENT=YES+cb; VISITOR_INFO1_LIVE=abc123
```

**‚úÖ Correto:**
```
.youtube.com	TRUE	/	TRUE	1735689600	CONSENT	YES+cb
.youtube.com	TRUE	/	FALSE	1735689600	VISITOR_INFO1_LIVE	abc123
```

**Diferen√ßa:** Tabs (`\t`) entre campos, n√£o espa√ßos!

---

## üí° Dica Final

**Melhor solu√ß√£o atual:**

```bash
# Use direto do navegador (sem exportar)
cd python
source .venv/bin/activate

python main.py download "URL" \
  --cookies-from-browser chrome \
  --out-dir ./downloads
```

**Isso resolve:**
- ‚úÖ Cookies sempre frescos
- ‚úÖ Sem exporta√ß√£o manual
- ‚úÖ Funciona mesmo com rate limit (se logado)

---

**Boa sorte! Se ainda n√£o funcionar, aguarde 12-24h para o rate limit expirar.** ‚è∞
